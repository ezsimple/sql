CREATE PROCEDURE  `SP_STATS_GAME_WINNER_SUMMARY`(
IN $GM_CODE CHAR(13),
IN $MM_CODE VARCHAR(10)
)
BEGIN

    DECLARE $MAX_RNDG INT;
    DECLARE STROKE1 INT;
    DECLARE STROKE2 INT;
    DECLARE STROKE3 INT;
    DECLARE STROKE4 INT;
    DECLARE TOTAL INT;

    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

    SELECT MAX(TOMT_RNDG) INTO $MAX_RNDG
    FROM VW_STATS_SCORE_COMMON
    WHERE GM_CODE = $GM_CODE;

    SELECT (H01+H02+H03+H04+H05+H06+H07+H08+H09+H10+H11+H12+H13+H14+H15+H16+H17+H18) INTO STROKE1
    FROM VW_STATS_SCORE_COMMON WHERE GM_CODE = $GM_CODE AND MAN_CD = $MM_CODE AND TOMT_RNDG = '1';

    SELECT (H01+H02+H03+H04+H05+H06+H07+H08+H09+H10+H11+H12+H13+H14+H15+H16+H17+H18) INTO STROKE2
    FROM VW_STATS_SCORE_COMMON WHERE GM_CODE = $GM_CODE AND MAN_CD = $MM_CODE AND TOMT_RNDG = '2';

    SELECT (H01+H02+H03+H04+H05+H06+H07+H08+H09+H10+H11+H12+H13+H14+H15+H16+H17+H18) INTO STROKE3
    FROM VW_STATS_SCORE_COMMON WHERE GM_CODE = $GM_CODE AND MAN_CD = $MM_CODE AND TOMT_RNDG = '3';

    SELECT (H01+H02+H03+H04+H05+H06+H07+H08+H09+H10+H11+H12+H13+H14+H15+H16+H17+H18) INTO STROKE4
    FROM VW_STATS_SCORE_COMMON WHERE GM_CODE = $GM_CODE AND MAN_CD = $MM_CODE AND TOMT_RNDG = '4';

    SELECT STROKE1, STROKE2, STROKE3, STROKE4, ($STROKE1+$STROKE2+$STROKE3+$STROKE4) AS TOTAL;

END;
